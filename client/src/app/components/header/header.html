<mat-toolbar class="bg-white border-b border-gray-200 px-4 sm:px-6">
  <!-- Logo & Brand -->
  <div class="flex items-center flex-none">
    <a routerLink="/" class="flex items-center gap-2 text-blue-600 hover:text-blue-700 transition-colors">
      <mat-icon class="text-2xl">devices</mat-icon>
      <span class="text-xl font-bold tracking-tight">TechZone</span>
    </a>
  </div>

  <!-- Search Bar -->
  <div class="flex-1 max-w-2xl mx-auto px-4" *ngIf="isLargeScreen">
    <form class="w-full" (ngSubmit)="onSearch()">
      <mat-form-field appearance="outline" class="w-full" subscriptSizing="dynamic">
        <mat-icon matPrefix class="text-gray-400">search</mat-icon>
        <input matInput
               type="search"
               [formControl]="searchControl"
               [matAutocomplete]="auto"
               placeholder="Search laptops, tablets, phones..."
               class="py-1">
        <button mat-icon-button matSuffix type="submit" class="text-gray-400 hover:text-blue-600 transition-colors">
          <mat-icon>arrow_forward</mat-icon>
        </button>
      </mat-form-field>
      
      <mat-autocomplete #auto="matAutocomplete" class="!bg-white">
        <mat-option *ngFor="let suggestion of filteredProducts | async" [value]="suggestion.name" class="hover:bg-gray-50">
          <mat-icon class="mr-2 text-gray-500">{{getCategoryIcon(suggestion.category)}}</mat-icon>
          <span>{{suggestion.name}}</span>
          <small class="ml-2 text-gray-500">${{suggestion.price}}</small>
        </mat-option>
      </mat-autocomplete>
    </form>
  </div>

  <!-- Navigation -->
  <div class="flex items-center gap-2 flex-none">
    <!-- Mobile Search Button -->
    <button mat-icon-button *ngIf="!isLargeScreen" (click)="toggleMobileSearch()">
      <mat-icon>search</mat-icon>
    </button>

    <a mat-button routerLink="/shop" *ngIf="isLargeScreen" class="inline-flex items-center gap-1">
      <mat-icon>store</mat-icon>
      <span>Shop</span>
    </a>

    <a mat-button routerLink="/deals" class="hidden 2xl:inline-flex items-center gap-1">
      <mat-icon>local_offer</mat-icon>
      <span>Deals</span>
    </a>

    <a mat-button routerLink="/support" class="hidden sm:inline-flex items-center gap-1">
      <mat-icon>help_outline</mat-icon>
      <span>Support</span>
    </a>

    <!-- Account Menu -->
    <button mat-icon-button [matMenuTriggerFor]="accountMenu" aria-label="Account menu">
      <mat-icon>person_outline</mat-icon>
    </button>
    
    <!-- Cart Button -->
    <button mat-icon-button 
            [matBadge]="cartItemCount" 
            [matBadgeHidden]="!cartItemCount" 
            matBadgeColor="warn"
            class="relative"
            aria-label="Shopping cart">
      <mat-icon>shopping_cart</mat-icon>
    </button>
  </div>
</mat-toolbar>

<!-- Account Menu -->
<mat-menu #accountMenu="matMenu" xPosition="before" class="!mt-2">
  <a mat-menu-item routerLink="/account/profile">
    <mat-icon>person</mat-icon>
    <span>Profile</span>
  </a>
  <a mat-menu-item routerLink="/account/orders">
    <mat-icon>shopping_bag</mat-icon>
    <span>Orders</span>
  </a>
  <a mat-menu-item routerLink="/account/wishlist">
    <mat-icon>favorite</mat-icon>
    <span>Wishlist</span>
  </a>
  <mat-divider></mat-divider>
  <button mat-menu-item (click)="logout()">
    <mat-icon>logout</mat-icon>
    <span>Sign Out</span>
  </button>
</mat-menu>

<!-- Mobile Search Overlay (shown when mobile search is active) -->
<div *ngIf="isMobileSearchVisible" 
     class="fixed inset-0 bg-white z-50 sm:hidden">
  <div class="p-4">
    <div class="flex items-center gap-2 mb-4">
      <button mat-icon-button (click)="toggleMobileSearch()">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <mat-form-field appearance="outline" class="w-full">
        <input matInput
               type="search"
               [formControl]="searchControl"
               [matAutocomplete]="mobileAuto"
               placeholder="Search products..."
               autofocus>
      </mat-form-field>
    </div>
    
    <mat-autocomplete #mobileAuto="matAutocomplete">
      <mat-option *ngFor="let suggestion of filteredProducts | async" [value]="suggestion.name">
        <mat-icon class="mr-2 text-gray-500">{{getCategoryIcon(suggestion.category)}}</mat-icon>
        <span>{{suggestion.name}}</span>
        <small class="ml-2 text-gray-500">${{suggestion.price}}</small>
      </mat-option>
    </mat-autocomplete>
  </div>
</div>
